<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kehadiran Siswa</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial; background:#f4f6f8; margin:0 }
header { background:#1e88e5; color:white; padding:20px; text-align:center }
.container { padding:20px }
input, button {
  width:100%; padding:10px; margin-top:10px;
  border-radius:6px; border:1px solid #ccc
}
button { background:#1e88e5; color:white; border:none }
.card {
  background:white; padding:15px; margin-top:15px; border-radius:8px
}
</style>
</head>

<body>

<header>
<h2>üîê Cek Kehadiran Siswa</h2>
<a href="index.html" style="color:white">‚Üê Kembali</a>
</header>

<div class="container">
  <input id="kode" placeholder="Masukkan Kode Orang Tua">
  <button onclick="cek()">Lihat Kehadiran</button>
  <div id="hasil"></div>
</div>

<script>
async function cekKehadiran() {
  const kodeInput = document.getElementById("kode").value.trim();
  const hasil = document.getElementById("hasil");

  try {
    const res = await fetch("data/kehadiran.csv");
    const text = await res.text();

    const rows = text.trim().split("\n").slice(1);
    let output = "";

    rows.forEach(row => {
      // üîë AUTO DETECT delimiter
      const delimiter = row.includes(";") ? ";" : ",";
      const cols = row.split(delimiter).map(c => c.trim());

      if (cols.length >= 4) {
        const kode = cols[0];
        const nama = cols[1];
        const tanggal = cols[2];
        const status = cols[3];

        if (kode === kodeInput) {
          output += `
            <div class="card">
              <b>${tanggal}</b><br>
              Nama: ${nama}<br>
              Status: ${status}
            </div>
          `;
        }
      }
    });

    hasil.innerHTML = output || "<p>Data kehadiran tidak ditemukan</p>";

  } catch (e) {
    hasil.innerHTML = "<p>Gagal membaca data kehadiran</p>";
    console.error(e);
  }
}
</script>

</body>
</html>
